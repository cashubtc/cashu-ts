{"version":3,"file":"NUT20.cjs.js","sources":["../../../src/crypto/client/NUT20.ts"],"sourcesContent":["import { schnorr } from '@noble/curves/secp256k1';\nimport { type SerializedBlindedMessage } from '../../model/types';\nimport { bytesToHex, hexToBytes } from '@noble/hashes/utils';\nimport { sha256 } from '@noble/hashes/sha256';\n\nfunction constructMessage(quote: string, blindedMessages: SerializedBlindedMessage[]): Uint8Array {\n\tlet message = quote;\n\tfor (const blindedMessage of blindedMessages) {\n\t\tmessage += blindedMessage.B_;\n\t}\n\tconst msgbytes = new TextEncoder().encode(message);\n\treturn sha256(msgbytes);\n}\n\nexport function signMintQuote(\n\tprivkey: string,\n\tquote: string,\n\tblindedMessages: SerializedBlindedMessage[],\n): string {\n\tconst message = constructMessage(quote, blindedMessages);\n\tconst privkeyBytes = hexToBytes(privkey);\n\tconst signature = schnorr.sign(message, privkeyBytes);\n\treturn bytesToHex(signature);\n}\n\nexport function verifyMintQuoteSignature(\n\tpubkey: string,\n\tquote: string,\n\tblindedMessages: SerializedBlindedMessage[],\n\tsignature: string,\n): boolean {\n\tconst sigbytes = hexToBytes(signature);\n\tlet pubkeyBytes = hexToBytes(pubkey);\n\tif (pubkeyBytes.length !== 33) return false;\n\tpubkeyBytes = pubkeyBytes.slice(1);\n\tconst message = constructMessage(quote, blindedMessages);\n\treturn schnorr.verify(sigbytes, message, pubkeyBytes);\n}\n"],"names":["constructMessage","quote","blindedMessages","message","blindedMessage","msgbytes","sha256","signMintQuote","privkey","privkeyBytes","hexToBytes","signature","schnorr","bytesToHex","verifyMintQuoteSignature","pubkey","sigbytes","pubkeyBytes"],"mappings":"8LAKA,SAASA,EAAiBC,EAAeC,EAAyD,CACjG,IAAIC,EAAUF,EACd,UAAWG,KAAkBF,EAC5BC,GAAWC,EAAe,GAE3B,MAAMC,EAAW,IAAI,cAAc,OAAOF,CAAO,EACjD,OAAOG,EAAAA,OAAOD,CAAQ,CACvB,CAEO,SAASE,EACfC,EACAP,EACAC,EACS,CACT,MAAMC,EAAUH,EAAiBC,EAAOC,CAAe,EACjDO,EAAeC,EAAAA,WAAWF,CAAO,EACjCG,EAAYC,EAAAA,QAAQ,KAAKT,EAASM,CAAY,EACpD,OAAOI,EAAAA,WAAWF,CAAS,CAC5B,CAEO,SAASG,EACfC,EACAd,EACAC,EACAS,EACU,CACV,MAAMK,EAAWN,EAAAA,WAAWC,CAAS,EACrC,IAAIM,EAAcP,EAAAA,WAAWK,CAAM,EACnC,GAAIE,EAAY,SAAW,GAAI,MAAO,GACtCA,EAAcA,EAAY,MAAM,CAAC,EACjC,MAAMd,EAAUH,EAAiBC,EAAOC,CAAe,EACvD,OAAOU,EAAAA,QAAQ,OAAOI,EAAUb,EAASc,CAAW,CACrD"}