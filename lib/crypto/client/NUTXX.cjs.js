"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const f=require("@noble/curves/abstract/utils"),g=require("@noble/hashes/utils"),m=require("@noble/hashes/blake2"),E=require("../common/NUT10.cjs.js"),a=require("stwo-cairo"),l=(1n<<251n)+17n*(1n<<192n)+1n;class u{constructor(e){this.v=e}static fromHex(e){let t=e.startsWith("-");t&&(e=e.slice(1));let o=BigInt(e);t&&(o=-o);const r=(o%l+l)%l;return new u(r)}toBytesLE(e=32){const t=new Uint8Array(e);let o=this.v;for(let r=0;r<e;r++)t[r]=Number(o&0xffn),o>>=8n;return t}}const d=n=>{const e=["Cairo",{nonce:f.bytesToHex(g.randomBytes(32)),data:n}];return JSON.stringify(e)},x=n=>{const t=new Uint8Array(n.length*32);return n.forEach((o,r)=>{const s=u.fromHex(o).toBytesLE(32);t.set(s,r*32)}),h(t)},h=n=>{let e=new m.BLAKE2s;return n.forEach(t=>e.update(new Uint8Array([t]))),e.digest()},P=async(n,e,t)=>{let o=Date.now();console.log("Executing cairo program...");const r=await a.execute(e,...t);console.log("Execution complete in",Date.now()-o,"ms");const s=a.containsPedersenBuiltin(r);o=Date.now(),console.log("Proving cairo execution...");const w=await a.prove(r);return console.log("Proving complete in",Date.now()-o,"ms"),n.forEach(c=>{try{if(console.log("adding cairo witness to proof with amount:",c.amount),E.parseSecret(c.secret)[0]!=="Cairo")throw new Error("not a Cairo secret");const y={cairo_proof_json:w,with_pedersen:s,with_bootloader:!1};c.witness=JSON.stringify(y)}catch(i){throw console.error("Failed to attach Cairo witness:",i),i}}),n};exports.cairoProveProofs=P;exports.createCairoSecret=d;exports.hashByteArray=h;exports.hashExecutableBytecode=x;
//# sourceMappingURL=NUTXX.cjs.js.map
